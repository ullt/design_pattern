# 工厂模式

## 定义
> 当对象的创建逻辑比较复杂，不只是简单的new一下就可以，而是要组合其他类对象，做各种初始化操作时，推荐使用工厂模式

## 何时使用
* 创建对象比较复杂
* 不同条件下创建不同实例时

### 简单工厂
> 简单工厂是将不同创建逻辑放到一个工厂类中，if-else 逻辑在这个工厂类中

### 工厂方法
> 工厂方法是将不同创建逻辑放到不同工厂类中，先用一个工厂类的工厂来来得到某个工厂，再用这个工厂来创建，if-else 逻辑在工厂类的工厂中

### 抽象工厂
> 一个具体工厂有多个产品生产线，其他的同工厂方法

### 建造者模式
> 将一个复杂的对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示

#### 适合场景
* 产品类非常复杂或者产品类因为调用顺序不同而产生不同作用
* 初始化一个对象时，参数过多，或者很多参数具有默认值

#### 问题
* 考虑可变参+函数参数是否可以实现建造者模式？

### 原型模式
> 如果对象的创建成本比较大，而同一个类的不同对象之间差别不大（大部分字段都相同）
> 在这种情况下，我们可以利用对已有对象（原型）进行复制（或者叫拷贝）的方式来创建新对象，以达到节省创建时间的目的。
> 这种基于原型来创建对象的方式就叫作原型设计模式，简称原型模式

#### 什么时候对象创建成本大？
* 如果对象中的数据需要经过复杂的计算才能得到（比如排序、计算哈希值）
* 需要从 RPC、网络、数据库、文件系统等非常慢速的 IO 中读取
* ...

```这种情况我们就可以利用原型模式，从其他已有对象中直接拷贝得到，而不用每次在创建新对象的时候，都重复执行这些耗时的操作。```

#### 深拷贝、浅拷贝
> 如果要拷贝的对象是不可变对象，浅拷贝共享不可变对象是没问题的，
> 但对于可变对象来说，浅拷贝得到的对象和原始对象会共享部分数据，就有可能出现数据被修改的风险，也就变得复杂多
>
> PS: 没有充分的理由，不要使用浅拷贝

## 注意
* 复杂度无法被消除，只能被转移